<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>WaryWEB | Crossword</title>
  <link href="https://fonts.googleapis.com/css2?family=Satisfy&family=Space+Grotesk:wght@300;400;500;600;700&family=Inter:wght@300;400;500;600&family=Open+Sans:wght@400;700&display=swap" rel="stylesheet">
  <style>
    :root {
        --primary-dark: #0c0c0c;
        --primary-light: #ffffff;
        --accent-red: #FF4136;
        --accent-yellow: #FFDC00;
        --transition-slow: 0.6s cubic-bezier(0.25, 1, 0.5, 1);
        --transition-fast: 0.3s ease;
        --section-spacing: 80px;
        --board-bg: #bbada0;
        --empty-cell: #ccc0b3;
        --font-color-light: #f9f6f2;
        --font-color-dark: #776e65;
        --fixed-tile-bg: #e5e5e5;
        --user-tile-bg: #ffffff;
        --active-tile-bg: #c9e0ff;
        --highlight-bg: #d6eaf8;
    }

    body.dark-mode {
        --primary-dark: #0c0c0c;
        --primary-light: #ffffff;
        --fixed-tile-bg: #333;
        --user-tile-bg: #222;
        --active-tile-bg: #555;
        --highlight-bg: #4a668b;
    }

    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
    }

    body {
        font-family: 'Inter', sans-serif;
        color: var(--primary-dark);
        background-color: var(--primary-light);
        overflow-x: hidden;
        line-height: 1.6;
        transition: background-color 0.5s ease;
    }

    body.dark-mode {
        background-color: var(--primary-dark);
        color: var(--primary-light);
    }

    h1, h2, h3, h4, h5, h6 {
        font-family: 'Space Grotesk', sans-serif;
        font-weight: 600;
        letter-spacing: -0.02em;
    }

    .container {
        max-width: 1440px;
        margin: 0 auto;
        padding: 0 20px;
    }

    /* Navigation */
    nav {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 16px 20px;
        z-index: 1000;
        background: rgba(255, 255, 255, 0.8);
        backdrop-filter: blur(10px);
        transition: var(--transition-fast);
        box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }

    body.dark-mode nav {
        background: rgba(12, 12, 12, 0.8);
        box-shadow: 0 2px 10px rgba(255,255,255,0.1);
    }

    .nav-left {
        display: flex;
        align-items: center;
        gap: 10px;
        width: 100%;
        justify-content: space-between;
        padding-right: 20px;
    }

    .logo {
        font-family: 'Space Grotesk', sans-serif;
        font-weight: 700;
        font-size: 24px;
        position: relative;
        cursor: pointer;
        text-decoration: none;
        color: inherit;
        white-space: nowrap;
    }

    .logo-message {
        font-family: 'Satisfy', cursive;
        font-size: 1.5rem;
        font-weight: 500;
        color: #666;
        transition: color 0.3s ease;
        flex-grow: 1;
        text-align: center;
    }

    .mode-toggle {
        width: 50px;
        height: 24px;
        background: #e0e0e0;
        border-radius: 12px;
        position: relative;
        cursor: pointer;
        transition: var(--transition-fast);
        flex-shrink: 0;
    }

    body.dark-mode .mode-toggle {
        background: #333;
    }

    .toggle-thumb {
        width: 20px;
        height: 20px;
        background: var(--primary-light);
        border-radius: 50%;
        position: absolute;
        top: 2px;
        left: 2px;
        transition: transform 0.3s ease;
    }

    body.dark-mode .toggle-thumb {
        transform: translateX(26px);
        background: var(--primary-dark);
    }

    /* Main Section */
    .section-title {
        font-size: 2.5rem;
        margin-bottom: 30px;
        text-align: center;
        position: relative;
    }

    .section-title::after {
        content: '';
        position: absolute;
        bottom: -10px;
        left: 50%;
        transform: translateX(-50%);
        width: 80px;
        height: 4px;
        background: linear-gradient(90deg, var(--accent-red), var(--accent-yellow));
        border-radius: 2px;
    }

    .game-section {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: flex-start;
        min-height: 100vh;
        padding: var(--section-spacing) 0;
        padding-top: 100px;
    }

    /* Crossword Container */
    .crossword-container {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 25px;
        width: 100%;
        max-width: 800px;
        padding: 20px;
    }

    .crossword-grid {
        display: grid;
        grid-template-columns: repeat(10, 1fr);
        grid-template-rows: repeat(10, 1fr);
        width: 100%;
        max-width: 500px;
        aspect-ratio: 1 / 1;
        background: var(--primary-light);
        border: 2px solid var(--primary-dark);
        border-radius: 12px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        overflow: hidden;
    }

    body.dark-mode .crossword-grid {
        background: var(--primary-dark);
        border-color: var(--primary-light);
        box-shadow: 0 4px 12px rgba(255,255,255,0.1);
    }

    .cell {
        position: relative;
        width: 100%;
        aspect-ratio: 1 / 1;
        border: 1px solid rgba(0,0,0,0.1);
        display: flex;
        justify-content: center;
        align-items: center;
        font-size: 1.2rem;
        text-transform: uppercase;
        font-weight: bold;
        cursor: pointer;
        background-color: var(--user-tile-bg);
        transition: background-color 0.2s ease, transform 0.1s ease;
    }

    .cell:active {
        transform: scale(0.95);
    }

    body.dark-mode .cell {
        border-color: rgba(255,255,255,0.1);
    }

    .cell.empty {
        background-color: transparent;
        border: none;
        cursor: default;
    }

    body.dark-mode .cell.empty {
        background-color: transparent;
    }

    .cell.active {
        background-color: var(--active-tile-bg);
    }

    .cell.highlight {
        background-color: var(--highlight-bg);
    }

    .cell.correct {
        background-color: #d4edda;
        color: #155724;
    }

    .cell.incorrect {
        background-color: #f8d7da;
        color: #721c24;
    }

    body.dark-mode .cell.correct {
        background-color: #155724;
        color: #d4edda;
    }

    body.dark-mode .cell.incorrect {
        background-color: #721c24;
        color: #f8d7da;
    }

    .cell-number {
        position: absolute;
        top: 2px;
        left: 2px;
        font-size: 0.7rem;
        font-weight: 500;
    }

    .cell-input {
        width: 100%;
        height: 100%;
        text-align: center;
        font-size: 1.2em;
        text-transform: uppercase;
        font-weight: bold;
        border: none;
        outline: none;
        background: transparent;
        color: inherit;
    }

    .cell.empty .cell-input {
        display: none;
    }

    .clues-container {
        display: flex;
        flex-direction: column;
        width: 100%;
        gap: 20px;
        margin-top: 20px;
    }

    .clues-group {
        border: 1px solid var(--primary-dark);
        padding: 15px;
        border-radius: 8px;
        background: var(--user-tile-bg);
        box-shadow: 0 2px 8px rgba(0,0,0,0.05);
    }

    body.dark-mode .clues-group {
        border-color: var(--primary-light);
        background: #222;
        box-shadow: 0 2px 8px rgba(255,255,255,0.05);
    }

    .clues-group h3 {
        font-size: 1.5rem;
        margin-bottom: 10px;
        text-align: center;
    }

    .clues-list {
        list-style-type: none;
        font-size: 1rem;
    }

    .clues-list li {
        margin-bottom: 5px;
    }

    .clues-list li.active-clue {
        font-weight: bold;
        color: var(--accent-red);
        transition: color 0.3s ease;
    }

    .game-controls {
        display: flex;
        gap: 15px;
        margin-top: 20px;
    }

    .game-controls button {
        /* Styles from the previous button */
        padding: 12px 24px;
        background: linear-gradient(90deg, var(--accent-red), var(--accent-yellow));
        color: white;
        border: none;
        border-radius: 8px;
        font-weight: bold;
        cursor: pointer;
        box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        transition: transform 0.2s ease;
    }

    .game-controls button:hover {
        transform: translateY(-2px);
    }

    /* New button styles from user */
    .button-54 {
        font-family: "Open Sans", sans-serif;
        font-size: 16px;
        letter-spacing: 2px;
        text-decoration: none;
        text-transform: uppercase;
        color: var(--primary-dark);
        background: transparent;
        cursor: pointer;
        border: 3px solid var(--primary-dark);
        padding: 0.25em 0.5em;
        box-shadow: 1px 1px 0px 0px var(--primary-dark), 2px 2px 0px 0px var(--primary-dark), 3px 3px 0px 0px var(--primary-dark), 4px 4px 0px 0px var(--primary-dark), 5px 5px 0px 0px var(--primary-dark);
        position: relative;
        user-select: none;
        -webkit-user-select: none;
        touch-action: manipulation;
        transition: box-shadow 0.2s ease, transform 0.2s ease;
    }

    .button-54:active {
        box-shadow: 0px 0px 0px 0px;
        top: 5px;
        left: 5px;
    }

    body.dark-mode .button-54 {
        color: var(--primary-light);
        border: 3px solid var(--primary-light);
        box-shadow: 1px 1px 0px 0px var(--primary-light), 2px 2px 0px 0px var(--primary-light), 3px 3px 0px 0px var(--primary-light), 4px 4px 0px 0px var(--primary-light), 5px 5px 0px 0px var(--primary-light);
    }

    @media (min-width: 768px) {
        .button-54 {
            padding: 0.25em 0.75em;
        }
    }

    /* Custom Message Box */
    #message-box {
        background-color: #333;
        color: #fff;
        padding: 20px;
        border-radius: 12px;
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        text-align: center;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        z-index: 10000;
        display: none;
        max-width: 80%;
    }

    #message-box p {
        font-size: 1.2rem;
        margin-bottom: 15px;
    }

    #message-box button {
        padding: 10px 20px;
        background: linear-gradient(90deg, var(--accent-red), var(--accent-yellow));
        color: white;
        border: none;
        border-radius: 8px;
        font-weight: bold;
        cursor: pointer;
        box-shadow: 0 2px 5px rgba(0,0,0,0.2);
    }

    @media (min-width: 768px) {
        .crossword-container {
            flex-direction: row;
            align-items: flex-start;
            gap: 40px;
        }

        .clues-container {
            flex-direction: column;
        }
    }

    @media (max-width: 767px) {
        .crossword-grid {
            max-width: 350px;
        }
    }

  </style>
</head>
<body>
<nav>
  <div class="nav-left">
    <a href="#" class="logo">
      WaryWEB
    </a>
    <span class="logo-message">Play Crossword</span>
  </div>
  <div class="nav-actions">
    <div class="mode-toggle" id="modeToggle">
      <div class="toggle-thumb"></div>
    </div>
  </div>
</nav>

<section id="game-section" class="game-section">
  <div class="container">
    <h2 class="section-title">Crossword</h2>
    <div class="crossword-container">
      <div class="crossword-grid" id="crossword-grid"></div>
      <div class="clues-container">
        <div class="clues-group">
          <h3>Across</h3>
          <ul class="clues-list" id="across-clues"></ul>
        </div>
        <div class="clues-group">
          <h3>Down</h3>
          <ul class="clues-list" id="down-clues"></ul>
        </div>
      </div>
    </div>
    <div class="game-controls">
      <button id="next-puzzle" class="button-54">Next Puzzle</button>
      <button id="reset-puzzle" class="button-54">Reset Puzzle</button>
    </div>
  </div>
</section>

<!-- Custom Message Box -->
<div id="message-box">
  <p id="message-content">Congratulations! You solved the puzzle!</p>
  <button id="close-message">OK</button>
</div>

<script>
  // DOM Elements
  const modeToggle = document.getElementById('modeToggle');
  const crosswordGrid = document.getElementById('crossword-grid');
  const acrossCluesList = document.getElementById('across-clues');
  const downCluesList = document.getElementById('down-clues');
  const messageBox = document.getElementById('message-box');
  const messageContent = document.getElementById('message-content');
  const closeMessageButton = document.getElementById('close-message');
  const nextPuzzleButton = document.getElementById('next-puzzle');
  const resetPuzzleButton = document.getElementById('reset-puzzle');

  // Crossword data structure with multiple puzzles
  const puzzles = [
      {
          grid: [
              ['', '', '', '', 'A', '', '', '', '', ''],
              ['', '', 'E', 'N', 'G', 'I', 'N', 'E', '', ''],
              ['', '', '', '', 'R', '', '', '', '', ''],
              ['', '', '', '', 'O', '', 'L', '', 'T', ''],
              ['', '', 'D', 'O', 'C', 'T', 'O', 'R', 'S', ''],
              ['', '', '', '', 'A', '', 'C', '', 'I', ''],
              ['S', 'U', 'N', 'S', 'E', 'T', 'S', '', 'V', ''],
              ['', '', '', '', 'U', '', '', '', 'A', ''],
              ['', '', '', '', 'T', '', '', '', 'T', ''],
              ['', '', '', '', 'I', '', '', '', 'O', ''],
          ],
          across: {
              2: { start: [1, 2], answer: 'ENGINE', clue: 'A machine with moving parts.' },
              5: { start: [4, 2], answer: 'DOCTORS', clue: 'Medical practitioners.' },
              7: { start: [6, 0], answer: 'SUNSETS', clue: 'The daily disappearance of the sun.' },
          },
          down: {
              1: { start: [0, 4], answer: 'AEROSTATS', clue: 'Lighter-than-air aircrafts.' },
              3: { start: [4, 2], answer: 'DRUM', clue: 'A percussion instrument.' },
              4: { start: [3, 6], answer: 'CULTIVATION', clue: 'The act of preparing land for crops.' },
              6: { start: [6, 8], answer: 'SCIMITAR', clue: 'A curved sword used in Asian cultures.' },
          },
      },
      {
          grid: [
              ['C', 'A', 'N', 'D', 'L', 'E', '', '', '', ''],
              ['O', '', '', '', '', '', 'O', '', 'E', ''],
              ['M', '', '', '', '', '', 'N', '', 'L', ''],
              ['P', 'R', 'I', 'N', 'T', 'E', 'R', '', 'E', ''],
              ['U', '', '', '', '', '', 'A', '', 'V', ''],
              ['T', '', '', 'C', 'O', 'U', 'N', 'T', 'A', ''],
              ['E', '', '', '', '', '', 'T', '', 'T', ''],
              ['R', '', '', '', 'T', '', 'I', 'R', 'E', ''],
              ['', '', '', '', 'H', 'E', 'A', 'V', 'Y', ''],
              ['', '', '', '', 'L', '', 'K', '', '', ''],
          ],
          across: {
              1: { start: [0, 0], answer: 'CANDLE', clue: 'Provides light from a burning wick.' },
              4: { start: [3, 0], answer: 'PRINTER', clue: 'A device that puts text on paper.' },
              6: { start: [5, 3], answer: 'COUNT', clue: 'To determine the total number.' },
              8: { start: [7, 7], answer: 'TIGER', clue: 'A large, striped cat.' },
              9: { start: [8, 4], answer: 'HEAVY', clue: 'Having great weight.' },
          },
          down: {
              1: { start: [0, 0], answer: 'COMPUTER', clue: 'An electronic device for storing and processing data.' },
              2: { start: [3, 4], answer: 'TYPE', clue: 'A kind or category.' },
              3: { start: [2, 6], answer: 'ONCE', clue: 'One time.' },
              5: { start: [0, 8], answer: 'ELEVATION', clue: 'The act of raising or being raised.' },
              7: { start: [8, 6], answer: 'YAK', clue: 'A long-haired bovine animal from Tibet.' },
          },
      },
       {
          grid: [
              ['A', 'L', 'L', 'O', 'W', '', '', '', '', ''],
              ['P', '', 'E', '', 'L', '', '', '', '', ''],
              ['P', '', 'A', '', 'D', '', '', '', 'R', ''],
              ['L', 'O', 'O', 'P', '', 'B', 'O', 'O', 'T', ''],
              ['E', '', 'R', '', '', '', 'I', '', 'U', ''],
              ['', '', 'E', 'L', 'E', 'V', 'A', 'T', 'O', 'R'],
              ['', '', '', '', 'S', '', 'L', '', 'B', ''],
              ['', 'J', 'O', 'Y', '', '', 'N', '', 'Y', ''],
              ['', '', '', '', 'I', '', 'E', '', '', ''],
              ['', '', '', '', 'C', 'A', 'B', 'L', 'E', ''],
          ],
          across: {
              1: { start: [0, 0], answer: 'ALLOW', clue: 'To permit or let happen.' },
              4: { start: [3, 1], answer: 'LOOP', clue: 'A series of commands that is repeated.' },
              6: { start: [3, 6], answer: 'BOOT', clue: 'Starting up a computer.' },
              7: { start: [5, 2], answer: 'ELEVATOR', clue: 'A platform or cage for raising and lowering people or things.' },
              8: { start: [7, 1], answer: 'JOY', clue: 'A feeling of great pleasure and happiness.' },
              9: { start: [9, 4], answer: 'CABLE', clue: 'A thick wire or group of wires.' },
          },
          down: {
              2: { start: [0, 1], answer: 'PEAR', clue: 'A sweet, bell-shaped fruit.' },
              3: { start: [0, 3], answer: 'APPLE', clue: 'A common fruit; also a famous tech company.' },
              5: { start: [0, 4], answer: 'WELDER', clue: 'Someone who joins metal.' },
              6: { start: [3, 6], answer: 'BIKE', clue: 'A bicycle.' },
              7: { start: [3, 7], answer: 'BOY', clue: 'A young male human.' },
          },
      }
  ];

  let currentPuzzleIndex = 0;
  let activeCell = null;
  let activeDirection = 'across'; // 'across' or 'down'

  // Function to show a custom message box
  const showMessage = (message) => {
    messageContent.textContent = message;
    messageBox.style.display = 'block';
  };

  // Close message box
  closeMessageButton.addEventListener('click', () => {
    messageBox.style.display = 'none';
  });

  // Switch to the next puzzle
  nextPuzzleButton.addEventListener('click', () => {
    currentPuzzleIndex = (currentPuzzleIndex + 1) % puzzles.length;
    resetPuzzle();
  });

  // Reset the current puzzle
  resetPuzzleButton.addEventListener('click', resetPuzzle);

  function resetPuzzle() {
      const currentPuzzle = puzzles[currentPuzzleIndex];
      renderGrid();
      renderClues();
      activeCell = null;
      activeDirection = 'across';
      document.querySelectorAll('.cell.highlight, .cell.active, .clues-list li.active-clue, .cell.correct, .cell.incorrect').forEach(el => {
          el.classList.remove('highlight', 'active', 'active-clue', 'correct', 'incorrect');
      });
  }

  // Dark Mode Toggle
  modeToggle.addEventListener('click', () => {
    document.body.classList.toggle('dark-mode');
  });

  // Function to render the crossword grid
  const renderGrid = () => {
      crosswordGrid.innerHTML = '';
      const currentPuzzle = puzzles[currentPuzzleIndex];
      const size = currentPuzzle.grid.length;

      for (let row = 0; row < size; row++) {
          for (let col = 0; col < size; col++) {
              const cell = document.createElement('div');
              cell.classList.add('cell');

              const letter = currentPuzzle.grid[row][col];
              if (letter === '') {
                  cell.classList.add('empty');
              } else {
                  cell.setAttribute('data-row', row);
                  cell.setAttribute('data-col', col);
                  cell.innerHTML = `<span class="cell-number"></span><input type="text" maxlength="1" class="cell-input">`;

                  let clueNumber = null;
                  for (const [number, data] of Object.entries(currentPuzzle.across)) {
                      if (data.start[0] === row && data.start[1] === col) {
                          clueNumber = number;
                          break;
                      }
                  }
                  if (!clueNumber) {
                      for (const [number, data] of Object.entries(currentPuzzle.down)) {
                          if (data.start[0] === row && data.start[1] === col) {
                              clueNumber = number;
                              break;
                          }
                      }
                  }
                  if(clueNumber) {
                      cell.querySelector('.cell-number').textContent = clueNumber;
                  }
              }
              crosswordGrid.appendChild(cell);
          }
      }
  };

  // Function to render clues
  const renderClues = () => {
      acrossCluesList.innerHTML = '';
      downCluesList.innerHTML = '';
      const currentPuzzle = puzzles[currentPuzzleIndex];

      for (const [number, data] of Object.entries(currentPuzzle.across)) {
          const li = document.createElement('li');
          li.setAttribute('data-clue-number', number);
          li.setAttribute('data-direction', 'across');
          li.textContent = `${number}. ${data.clue}`;
          acrossCluesList.appendChild(li);
      }

      for (const [number, data] of Object.entries(currentPuzzle.down)) {
          const li = document.createElement('li');
          li.setAttribute('data-clue-number', number);
          li.setAttribute('data-direction', 'down');
          li.textContent = `${number}. ${data.clue}`;
          downCluesList.appendChild(li);
      }
  };

  // Check if the current word is correct and update cell colors
  const checkWord = () => {
      if (!activeCell) return;

      const row = parseInt(activeCell.dataset.row);
      const col = parseInt(activeCell.dataset.col);
      const currentPuzzle = puzzles[currentPuzzleIndex];

      // Find the start of the current word
      let startRow = row, endRow = row, startCol = col, endCol = col;
      let wordCells = [];

      if (activeDirection === 'across') {
          while (startCol >= 0 && currentPuzzle.grid[row][startCol] !== '') { startCol--; }
          startCol++;
          while (endCol < 10 && currentPuzzle.grid[row][endCol] !== '') { endCol++; }
          endCol--;

          for (let i = startCol; i <= endCol; i++) {
              wordCells.push(document.querySelector(`[data-row='${row}'][data-col='${i}']`));
          }

      } else { // 'down'
          while (startRow >= 0 && currentPuzzle.grid[startRow][col] !== '') { startRow--; }
          startRow++;
          while (endRow < 10 && currentPuzzle.grid[endRow][col] !== '') { endRow++; }
          endRow--;

          for (let i = startRow; i <= endRow; i++) {
              wordCells.push(document.querySelector(`[data-row='${i}'][data-col='${col}']`));
          }
      }

      // Construct the user's word and the correct answer
      let userWord = '';
      let correctWord = '';

      wordCells.forEach(cell => {
          const input = cell.querySelector('.cell-input');
          if (input) userWord += input.value.toUpperCase();
          correctWord += currentPuzzle.grid[parseInt(cell.dataset.row)][parseInt(cell.dataset.col)];
      });

      // Apply correct or incorrect classes
      const isCorrect = userWord === correctWord;
      wordCells.forEach(cell => {
          cell.classList.remove('correct', 'incorrect');
          if (userWord.length === correctWord.length && userWord !== '') {
              if (isCorrect) {
                  cell.classList.add('correct');
              } else {
                  cell.classList.add('incorrect');
              }
          }
      });

  };

  // Highlight cells for the current word and active clue
  const highlightCells = () => {
      document.querySelectorAll('.cell.highlight, .cell.active').forEach(cell => {
          cell.classList.remove('highlight', 'active');
      });
      document.querySelectorAll('.clues-list li').forEach(li => {
          li.classList.remove('active-clue');
      });

      if (!activeCell) return;

      const row = parseInt(activeCell.dataset.row);
      const col = parseInt(activeCell.dataset.col);

      activeCell.classList.add('active');

      // Highlight cells for the active word
      let startRow, endRow, startCol, endCol;
      let activeClueNumber = null;
      const currentPuzzle = puzzles[currentPuzzleIndex];

      if (activeDirection === 'across') {
          startCol = col;
          while(startCol >= 0 && currentPuzzle.grid[row][startCol] !== '') { startCol--; }
          startCol++;
          endCol = col;
          while(endCol < 10 && currentPuzzle.grid[row][endCol] !== '') { endCol++; }
          endCol--;

          for (let i = startCol; i <= endCol; i++) {
              const cell = document.querySelector(`[data-row='${row}'][data-col='${i}']`);
              if (cell) cell.classList.add('highlight');
          }

          for (const [number, data] of Object.entries(currentPuzzle.across)) {
              if (data.start[0] === row && data.start[1] === startCol) {
                  activeClueNumber = number;
                  break;
              }
          }

      } else { // 'down'
          startRow = row;
          while(startRow >= 0 && currentPuzzle.grid[startRow][col] !== '') { startRow--; }
          startRow++;
          endRow = row;
          while(endRow < 10 && currentPuzzle.grid[endRow][col] !== '') { endRow++; }
          endRow--;

          for (let i = startRow; i <= endRow; i++) {
              const cell = document.querySelector(`[data-row='${i}'][data-col='${col}']`);
              if (cell) cell.classList.add('highlight');
          }

          for (const [number, data] of Object.entries(currentPuzzle.down)) {
              if (data.start[0] === startRow && data.start[1] === col) {
                  activeClueNumber = number;
                  break;
              }
          }
      }

      // Highlight the active clue in the list
      if (activeClueNumber) {
          document.querySelector(`[data-clue-number='${activeClueNumber}'][data-direction='${activeDirection}']`).classList.add('active-clue');
      }
  };

  // Check if the entire crossword is solved
  const checkSolution = () => {
      let isSolved = true;
      const currentPuzzle = puzzles[currentPuzzleIndex];

      for (let row = 0; row < 10; row++) {
          for (let col = 0; col < 10; col++) {
              const cell = document.querySelector(`[data-row='${row}'][data-col='${col}']`);
              if (cell && cell.querySelector('.cell-input').value.toUpperCase() !== currentPuzzle.grid[row][col]) {
                  isSolved = false;
                  break;
              }
          }
          if (!isSolved) break;
      }

      if (isSolved) {
          showMessage('Congratulations! You solved the puzzle!');
      }
  };

  // Event listener for cell clicks to activate them
  crosswordGrid.addEventListener('click', (event) => {
      const cell = event.target.closest('.cell');
      if (cell && !cell.classList.contains('empty')) {
          const newActiveCell = cell;
          if (activeCell === newActiveCell) {
              activeDirection = activeDirection === 'across' ? 'down' : 'across';
          } else {
              activeDirection = 'across';
          }
          activeCell = newActiveCell;
          highlightCells();
          activeCell.querySelector('.cell-input').focus();
      }
  });

  // Handle key presses for movement and input
  document.addEventListener('keydown', (event) => {
      if (!activeCell) return;

      const row = parseInt(activeCell.dataset.row);
      const col = parseInt(activeCell.dataset.col);
      let nextCell = null;
      let charInput = event.key.toUpperCase();

      if (event.key === 'ArrowRight') {
          activeDirection = 'across';
          nextCell = document.querySelector(`[data-row='${row}'][data-col='${col + 1}']`);
      } else if (event.key === 'ArrowLeft') {
          activeDirection = 'across';
          nextCell = document.querySelector(`[data-row='${row}'][data-col='${col - 1}']`);
      } else if (event.key === 'ArrowDown') {
          activeDirection = 'down';
          nextCell = document.querySelector(`[data-row='${row + 1}'][data-col='${col}']`);
      } else if (event.key === 'ArrowUp') {
          activeDirection = 'down';
          nextCell = document.querySelector(`[data-row='${row - 1}'][data-col='${col}']`);
      } else if (event.key.length === 1 && charInput.match(/[A-Z]/)) {
          const input = activeCell.querySelector('.cell-input');
          input.value = charInput;

          if (activeDirection === 'across') {
              nextCell = document.querySelector(`[data-row='${row}'][data-col='${col + 1}']`);
          } else {
              nextCell = document.querySelector(`[data-row='${row + 1}'][data-col='${col}']`);
          }
          checkWord(); // Check word after a character is entered
      } else if (event.key === 'Backspace' || event.key === 'Delete') {
          const input = activeCell.querySelector('.cell-input');
          input.value = '';

          if (activeDirection === 'across') {
              nextCell = document.querySelector(`[data-row='${row}'][data-col='${col - 1}']`);
          } else {
              nextCell = document.querySelector(`[data-row='${row - 1}'][data-col='${col}']`);
          }
          checkWord(); // Check word after a character is deleted
      }

      if (nextCell && !nextCell.classList.contains('empty')) {
          activeCell = nextCell;
          highlightCells();
          activeCell.querySelector('.cell-input').focus();
      } else {
          checkSolution(); // Check final solution if no more cells to move to
      }
  });

  // Initial render
  window.onload = () => {
      renderGrid();
      renderClues();
  };
</script>
</body>
</html>
